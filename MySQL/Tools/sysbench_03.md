# SYSBENCH_MYSQL

``` shell

# ls -Rlh /usr/local/share/sysbench/
/usr/local/share/sysbench/:
总用量 64K
-rwxr-xr-x 1 root root 1.5K 5月  16 17:49 bulk_insert.lua
-rw-r--r-- 1 root root  15K 5月  16 17:49 oltp_common.lua
-rwxr-xr-x 1 root root 1.3K 5月  16 17:49 oltp_delete.lua
-rwxr-xr-x 1 root root 2.4K 5月  16 17:49 oltp_insert.lua
-rwxr-xr-x 1 root root 1.3K 5月  16 17:49 oltp_point_select.lua
-rwxr-xr-x 1 root root 1.7K 5月  16 17:49 oltp_read_only.lua
-rwxr-xr-x 1 root root 1.9K 5月  16 17:49 oltp_read_write.lua
-rwxr-xr-x 1 root root 1.2K 5月  16 17:49 oltp_update_index.lua
-rwxr-xr-x 1 root root 1.2K 5月  16 17:49 oltp_update_non_index.lua
-rwxr-xr-x 1 root root 1.5K 5月  16 17:49 oltp_write_only.lua
-rwxr-xr-x 1 root root 2.0K 5月  16 17:49 select_random_points.lua
-rwxr-xr-x 1 root root 2.2K 5月  16 17:49 select_random_ranges.lua
drwxr-xr-x 4 root root 4.0K 5月  16 17:49 tests

# sysbench /usr/local/share/sysbench/oltp_read_write.lua --mysql-host=<IP> --mysql-port=<PORT> --mysql-user=<USERNAME> --mysql-password=<PASSWORD> --mysql-db='sysbench' --warmup-time=600 --time=3600 --events=0 --threads=16 --tables=16 --table_size=10000000 --mysql_storage_engine='innodb' --rate=0 --histogram=on --percentile=99 --report-interval=10 prepare / run / cleanup | tee /vipkid/sysbench_20190523.log
```
```shell
# R4.XLARGE:

[ 3510s ] thds: 16 tps: 553.50 qps: 11069.96 (r/w/o: 7748.97/2213.99/1107.00) lat (ms,99%): 69.29 err/s: 0.00 reconn/s: 0.00
[ 3520s ] thds: 16 tps: 554.80 qps: 11096.04 (r/w/o: 7767.23/2219.21/1109.60) lat (ms,99%): 71.83 err/s: 0.00 reconn/s: 0.00
[ 3530s ] thds: 16 tps: 578.70 qps: 11574.00 (r/w/o: 8101.80/2314.80/1157.40) lat (ms,99%): 66.84 err/s: 0.00 reconn/s: 0.00
[ 3540s ] thds: 16 tps: 583.20 qps: 11664.00 (r/w/o: 8164.80/2332.80/1166.40) lat (ms,99%): 63.32 err/s: 0.00 reconn/s: 0.00
[ 3550s ] thds: 16 tps: 603.90 qps: 12073.11 (r/w/o: 8451.34/2413.98/1207.79) lat (ms,99%): 70.55 err/s: 0.00 reconn/s: 0.00
[ 3560s ] thds: 16 tps: 603.10 qps: 12066.88 (r/w/o: 8446.66/2414.02/1206.21) lat (ms,99%): 66.84 err/s: 0.00 reconn/s: 0.00
[ 3570s ] thds: 16 tps: 615.89 qps: 12312.77 (r/w/o: 8619.61/2461.37/1231.79) lat (ms,99%): 68.05 err/s: 0.00 reconn/s: 0.00
[ 3580s ] thds: 16 tps: 637.11 qps: 12744.01 (r/w/o: 8920.38/2549.42/1274.21) lat (ms,99%): 69.29 err/s: 0.00 reconn/s: 0.00
[ 3590s ] thds: 16 tps: 626.50 qps: 12531.58 (r/w/o: 8772.38/2506.20/1253.00) lat (ms,99%): 70.55 err/s: 0.00 reconn/s: 0.00
[ 3600s ] thds: 16 tps: 650.90 qps: 13013.28 (r/w/o: 9109.29/2602.20/1301.80) lat (ms,99%): 68.05 err/s: 0.00 reconn/s: 0.00

Latency histogram (values are in milliseconds)
       value  ------------- distribution ------------- count
       7.430 |                                         1
       7.702 |                                         7
       7.842 |                                         21
       7.985 |                                         23
       8.130 |                                         66
       8.277 |                                         116
       8.428 |                                         231
       8.581 |                                         413
       8.737 |                                         772
       8.895 |                                         1312
       9.057 |                                         2277
       9.222 |*                                        3841
       9.389 |*                                        6287
       9.560 |**                                       9680
       9.734 |**                                       14242
       9.910 |****                                     20543
      10.090 |*****                                    28600
      10.274 |*******                                  38125
      10.460 |*********                                50034
      10.651 |***********                              63288
      10.844 |**************                           78582
      11.041 |*****************                        97166
      11.242 |********************                     116471
      11.446 |************************                 139150
      11.654 |*****************************            163329
      11.866 |*********************************        186653
      12.081 |************************************     206367
      12.301 |**************************************   219646
      12.524 |**************************************** 226685
      12.752 |**************************************** 228849
      12.984 |***************************************  224770
      13.219 |**************************************   218066
      13.460 |************************************     207293
      13.704 |*********************************        190023
      13.953 |******************************           172990
      14.207 |**************************               150255
      14.465 |***********************                  130244
      14.728 |*******************                      111330
      14.995 |*****************                        96462
      15.268 |***************                          85097
      15.545 |*************                            74635
      15.828 |************                             65923
      16.115 |**********                               59126
      16.408 |*********                                53590
      16.706 |********                                 48213
      17.010 |********                                 44429
      17.319 |*******                                  41606
      17.633 |*******                                  37953
      17.954 |******                                   34579
      18.280 |*****                                    30834
      18.612 |*****                                    27118
      18.950 |****                                     23138
      19.295 |***                                      19986
      19.645 |***                                      16513
      20.002 |**                                       14033
      20.366 |**                                       11864
      20.736 |**                                       9454
      21.112 |*                                        7676
      21.496 |*                                        6120
      21.886 |*                                        5074
      22.284 |*                                        4083
      22.689 |*                                        3212
      23.101 |                                         2521
      23.521 |                                         1981
      23.948 |                                         1764
      24.384 |                                         1400
      24.827 |                                         1283
      25.278 |                                         1043
      25.737 |                                         830
      26.205 |                                         871
      26.681 |                                         713
      27.165 |                                         568
      27.659 |                                         492
      28.162 |                                         564
      28.673 |                                         527
      29.194 |                                         550
      29.725 |                                         397
      30.265 |                                         363
      30.815 |                                         399
      31.375 |                                         394
      31.945 |                                         270
      32.525 |                                         453
      33.116 |                                         412
      33.718 |                                         380
      34.330 |                                         396
      34.954 |                                         376
      35.589 |                                         365
      36.236 |                                         482
      36.894 |                                         388
      37.565 |                                         526
      38.247 |                                         568
      38.942 |                                         607
      39.650 |                                         695
      40.370 |                                         761
      41.104 |                                         664
      41.851 |                                         692
      42.611 |                                         779
      43.385 |                                         635
      44.173 |                                         792
      44.976 |                                         833
      45.793 |                                         814
      46.625 |                                         1006
      47.472 |                                         894
      48.335 |                                         937
      49.213 |                                         1025
      50.107 |                                         953
      51.018 |                                         1232
      51.945 |                                         1073
      52.889 |                                         985
      53.850 |                                         941
      54.828 |                                         941
      55.824 |                                         892
      56.839 |                                         948
      57.871 |                                         856
      58.923 |                                         779
      59.993 |                                         807
      61.083 |                                         752
      62.193 |                                         731
      63.323 |                                         592
      64.474 |                                         578
      65.645 |                                         497
      66.838 |                                         489
      68.053 |                                         423
      69.289 |                                         383
      70.548 |                                         363
      71.830 |                                         287
      73.135 |                                         204
      74.464 |                                         186
      75.817 |                                         147
      77.194 |                                         131
      78.597 |                                         67
      80.025 |                                         67
      81.479 |                                         57
      82.959 |                                         90
      84.467 |                                         25
      86.002 |                                         44
      87.564 |                                         24
      89.155 |                                         30
      90.775 |                                         8
      92.424 |                                         27
      94.104 |                                         11
      95.814 |                                         7
      97.555 |                                         22
      99.327 |                                         18
     101.132 |                                         20
     102.969 |                                         6
     104.840 |                                         4
     106.745 |                                         5
     108.685 |                                         10
     110.659 |                                         6
     112.670 |                                         11
     114.717 |                                         15
     116.802 |                                         23
     118.924 |                                         17
     121.085 |                                         11
     123.285 |                                         10
     125.525 |                                         9
     127.805 |                                         11
     130.128 |                                         7
     134.899 |                                         8
     137.350 |                                         15
     139.846 |                                         18
     142.387 |                                         13
     144.974 |                                         10
     153.021 |                                         2
     155.801 |                                         19
     158.632 |                                         11
     215.443 |                                         9
     219.358 |                                         11
     223.344 |                                         2
     419.448 |                                         7
     427.069 |                                         9
     475.794 |                                         1

SQL statistics:
    queries performed:
        read:                            58489620
        write:                           16711323
        other:                           8355674
        total:                           83556617
    transactions:                        4177844 (1160.51 per sec.)
    queries:                             83556617 (23210.07 per sec.)
    ignored errors:                      2      (0.00 per sec.)
    reconnects:                          0      (0.00 per sec.)

Throughput:
    events/s (eps):                      1160.5074
    time elapsed:                        3600.0153s
    total number of events:              4177844

Latency (ms):
         min:                                    7.43
         avg:                                   13.79
         max:                                  475.64
         99th percentile:                       24.38
         sum:                             57595063.30

Threads fairness:
    events (avg/stddev):           261115.1250/4722.67
    execution time (avg/stddev):   3599.6915/0.01

# R5.XLARGE:

[ 3510s ] thds: 16 tps: 116.90 qps: 2337.50 (r/w/o: 1636.10/467.60/233.80) lat (ms,99%): 623.33 err/s: 0.00 reconn/s: 0.00
[ 3520s ] thds: 16 tps: 112.20 qps: 2242.29 (r/w/o: 1569.29/448.60/224.40) lat (ms,99%): 773.68 err/s: 0.00 reconn/s: 0.00
[ 3530s ] thds: 16 tps: 103.10 qps: 2066.51 (r/w/o: 1446.91/413.40/206.20) lat (ms,99%): 746.32 err/s: 0.00 reconn/s: 0.00
[ 3540s ] thds: 16 tps: 107.00 qps: 2139.60 (r/w/o: 1498.20/427.40/214.00) lat (ms,99%): 707.07 err/s: 0.00 reconn/s: 0.00
[ 3550s ] thds: 16 tps: 122.40 qps: 2446.43 (r/w/o: 1711.75/489.89/244.79) lat (ms,99%): 657.93 err/s: 0.00 reconn/s: 0.00
[ 3560s ] thds: 16 tps: 118.70 qps: 2370.46 (r/w/o: 1658.94/474.11/237.41) lat (ms,99%): 580.02 err/s: 0.00 reconn/s: 0.00
[ 3570s ] thds: 16 tps: 109.50 qps: 2195.68 (r/w/o: 1538.19/438.50/219.00) lat (ms,99%): 773.68 err/s: 0.00 reconn/s: 0.00
[ 3580s ] thds: 16 tps: 115.40 qps: 2305.92 (r/w/o: 1614.01/461.10/230.80) lat (ms,99%): 694.45 err/s: 0.00 reconn/s: 0.00
[ 3590s ] thds: 16 tps: 110.40 qps: 2210.56 (r/w/o: 1547.17/442.59/220.80) lat (ms,99%): 682.06 err/s: 0.00 reconn/s: 0.00
[ 3600s ] thds: 16 tps: 125.40 qps: 2502.05 (r/w/o: 1750.44/500.81/250.81) lat (ms,99%): 590.56 err/s: 0.00 reconn/s: 0.00
Latency histogram (values are in milliseconds)
       value  ------------- distribution ------------- count
       3.488 |                                         2
       3.551 |                                         3
       3.615 |                                         12
       3.681 |                                         38
       3.748 |*                                        114
       3.816 |*                                        173
       3.885 |**                                       195
       3.956 |**                                       235
       4.028 |***                                      313
       4.101 |**                                       287
       4.176 |**                                       221
       4.252 |**                                       204
       4.329 |**                                       187
       4.407 |*                                        106
       4.487 |*                                        94
       4.569 |*                                        75
       4.652 |                                         57
       4.737 |                                         37
       4.823 |                                         35
       4.910 |                                         40
       4.999 |                                         40
       5.090 |                                         49
       5.183 |                                         57
       5.277 |                                         60
       5.373 |*                                        69
       5.470 |*                                        64
       5.570 |*                                        71
       5.671 |*                                        83
       5.774 |*                                        79
       5.879 |*                                        82
       5.986 |*                                        101
       6.095 |*                                        126
       6.205 |*                                        121
       6.318 |*                                        143
       6.433 |*                                        151
       6.550 |*                                        160
       6.669 |**                                       191
       6.790 |*                                        163
       6.913 |*                                        183
       7.039 |**                                       203
       7.167 |**                                       211
       7.297 |**                                       234
       7.430 |**                                       236
       7.565 |**                                       304
       7.702 |**                                       291
       7.842 |**                                       266
       7.985 |***                                      325
       8.130 |***                                      316
       8.277 |***                                      349
       8.428 |***                                      358
       8.581 |***                                      410
       8.737 |***                                      382
       8.895 |***                                      430
       9.057 |****                                     461
       9.222 |****                                     480
       9.389 |****                                     535
       9.560 |*****                                    561
       9.734 |*****                                    585
       9.910 |****                                     557
      10.090 |*****                                    627
      10.274 |*****                                    652
      10.460 |*****                                    622
      10.651 |******                                   765
      10.844 |*****                                    678
      11.041 |******                                   800
      11.242 |******                                   768
      11.446 |******                                   783
      11.654 |*******                                  834
      11.866 |******                                   805
      12.081 |*******                                  823
      12.301 |*******                                  889
      12.524 |*******                                  850
      12.752 |*******                                  887
      12.984 |*******                                  929
      13.219 |********                                 1016
      13.460 |********                                 959
      13.704 |********                                 1019
      13.953 |*********                                1103
      14.207 |*********                                1117
      14.465 |*********                                1162
      14.728 |**********                               1224
      14.995 |**********                               1219
      15.268 |**********                               1254
      15.545 |***********                              1359
      15.828 |************                             1440
      16.115 |************                             1467
      16.408 |*************                            1590
      16.706 |*************                            1623
      17.010 |**************                           1703
      17.319 |**************                           1743
      17.633 |***************                          1799
      17.954 |***************                          1823
      18.280 |***************                          1909
      18.612 |****************                         1957
      18.950 |****************                         1976
      19.295 |*****************                        2088
      19.645 |****************                         2044
      20.002 |*****************                        2149
      20.366 |******************                       2195
      20.736 |*******************                      2296
      21.112 |*******************                      2342
      21.496 |********************                     2467
      21.886 |*********************                    2629
      22.284 |********************                     2543
      22.689 |*********************                    2635
      23.101 |**********************                   2689
      23.521 |************************                 2925
      23.948 |************************                 2931
      24.384 |************************                 3006
      24.827 |*************************                3047
      25.278 |**************************               3181
      25.737 |**************************               3262
      26.205 |**************************               3259
      26.681 |**************************               3268
      27.165 |****************************             3461
      27.659 |***************************              3353
      28.162 |****************************             3534
      28.673 |****************************             3523
      29.194 |******************************           3710
      29.725 |******************************           3739
      30.265 |******************************           3687
      30.815 |********************************         3946
      31.375 |*********************************        4070
      31.945 |********************************         3947
      32.525 |*********************************        4070
      33.116 |**********************************       4220
      33.718 |**********************************       4218
      34.330 |**********************************       4248
      34.954 |************************************     4457
      35.589 |************************************     4409
      36.236 |************************************     4440
      36.894 |************************************     4505
      37.565 |************************************     4474
      38.247 |*************************************    4543
      38.942 |**************************************   4719
      39.650 |*************************************    4593
      40.370 |***************************************  4860
      41.104 |**************************************   4741
      41.851 |**************************************   4716
      42.611 |**************************************   4721
      43.385 |***************************************  4844
      44.173 |**************************************   4770
      44.976 |***************************************  4821
      45.793 |***************************************  4838
      46.625 |**************************************   4698
      47.472 |**************************************   4754
      48.335 |**************************************** 4962
      49.213 |***************************************  4822
      50.107 |***************************************  4835
      51.018 |**************************************** 4942
      51.945 |***************************************  4845
      52.889 |**************************************   4735
      53.850 |**************************************   4712
      54.828 |*************************************    4613
      55.824 |*************************************    4614
      56.839 |**************************************   4654
      57.871 |*************************************    4613
      58.923 |*************************************    4571
      59.993 |************************************     4462
      61.083 |***********************************      4394
      62.193 |************************************     4438
      63.323 |***********************************      4390
      64.474 |***********************************      4358
      65.645 |***********************************      4345
      66.838 |************************************     4414
      68.053 |**********************************       4227
      69.289 |**********************************       4157
      70.548 |**********************************       4215
      71.830 |**********************************       4246
      73.135 |*********************************        4129
      74.464 |**********************************       4260
      75.817 |*********************************        4118
      77.194 |**********************************       4224
      78.597 |*********************************        4135
      80.025 |**********************************       4229
      81.479 |**********************************       4196
      82.959 |***********************************      4326
      84.467 |**********************************       4232
      86.002 |***********************************      4321
      87.564 |***********************************      4361
      89.155 |***********************************      4397
      90.775 |************************************     4485
      92.424 |***********************************      4376
      94.104 |************************************     4419
      95.814 |************************************     4483
      97.555 |***********************************      4376
      99.327 |************************************     4410
     101.132 |***********************************      4347
     102.969 |***********************************      4385
     104.840 |**********************************       4269
     106.745 |**********************************       4190
     108.685 |**********************************       4198
     110.659 |**********************************       4257
     112.670 |********************************         4028
     114.717 |*******************************          3907
     116.802 |********************************         3930
     118.924 |*******************************          3868
     121.085 |******************************           3697
     123.285 |******************************           3682
     125.525 |****************************             3429
     127.805 |***************************              3374
     130.128 |****************************             3494
     132.492 |**************************               3286
     134.899 |***************************              3304
     137.350 |***************************              3293
     139.846 |**************************               3265
     142.387 |*************************                3069
     144.974 |**************************               3186
     147.608 |************************                 3034
     150.290 |************************                 2986
     153.021 |************************                 2962
     155.801 |*************************                3053
     158.632 |************************                 3032
     161.514 |************************                 2993
     164.449 |*************************                3119
     167.437 |************************                 2953
     170.479 |***********************                  2913
     173.577 |************************                 2960
     176.731 |************************                 2948
     179.942 |***********************                  2842
     183.211 |**********************                   2774
     186.540 |**********************                   2749
     189.929 |**********************                   2733
     193.380 |*********************                    2577
     196.894 |*********************                    2576
     200.472 |********************                     2487
     204.114 |********************                     2448
     207.823 |*******************                      2356
     211.599 |******************                       2245
     215.443 |******************                       2234
     219.358 |*****************                        2104
     223.344 |******************                       2172
     227.402 |****************                         2023
     231.534 |*****************                        2057
     235.740 |****************                         1978
     240.024 |***************                          1916
     244.385 |***************                          1828
     248.825 |***************                          1901
     253.346 |**************                           1740
     257.950 |**************                           1734
     262.636 |*************                            1661
     267.408 |*************                            1636
     272.267 |************                             1535
     277.214 |************                             1487
     282.251 |************                             1438
     287.379 |***********                              1352
     292.601 |***********                              1346
     297.917 |**********                               1282
     303.330 |***********                              1308
     308.842 |**********                               1231
     314.453 |*********                                1154
     320.167 |*********                                1071
     325.984 |*********                                1172
     331.907 |*********                                1058
     337.938 |********                                 952
     344.078 |*******                                  902
     350.330 |********                                 931
     356.695 |*******                                  812
     363.176 |******                                   796
     369.775 |*******                                  822
     376.494 |******                                   761
     383.334 |******                                   727
     390.299 |*****                                    619
     397.391 |*****                                    596
     404.611 |****                                     541
     411.963 |*****                                    589
     419.448 |****                                     497
     427.069 |****                                     501
     434.829 |****                                     481
     442.730 |***                                      396
     450.774 |***                                      388
     458.964 |***                                      393
     467.304 |***                                      351
     475.794 |***                                      338
     484.439 |***                                      322
     493.242 |**                                       296
     502.204 |**                                       289
     511.328 |**                                       292
     520.619 |**                                       229
     530.078 |**                                       222
     539.710 |**                                       195
     549.516 |**                                       189
     559.501 |*                                        177
     569.667 |*                                        163
     580.017 |*                                        161
     590.556 |*                                        163
     601.286 |*                                        131
     612.211 |*                                        128
     623.335 |*                                        116
     634.661 |*                                        87
     646.192 |*                                        97
     657.933 |*                                        101
     669.888 |*                                        84
     682.059 |*                                        75
     694.452 |*                                        84
     707.070 |*                                        72
     719.917 |                                         50
     732.998 |                                         50
     746.316 |                                         44
     759.876 |                                         51
     773.683 |                                         45
     787.741 |                                         38
     802.053 |                                         41
     816.626 |                                         27
     831.464 |                                         24
     846.572 |                                         23
     861.954 |                                         27
     877.615 |                                         23
     893.561 |                                         19
     909.797 |                                         14
     926.327 |                                         5
     943.158 |                                         6
     960.295 |                                         10
     977.743 |                                         12
     995.508 |                                         17
    1013.597 |                                         11
    1032.013 |                                         7
    1050.764 |                                         8
    1069.856 |                                         10
    1089.295 |                                         8
    1109.087 |                                         5
    1129.239 |                                         7
    1149.757 |                                         6
    1170.648 |                                         4
    1191.918 |                                         2
    1213.575 |                                         5
    1235.625 |                                         1
    1258.076 |                                         2
    1280.934 |                                         1
    1304.208 |                                         2
    1327.905 |                                         1
    1352.033 |                                         4
    1376.599 |                                         1
    1427.078 |                                         1
    1453.007 |                                         1
    1533.657 |                                         1
    1589.895 |                                         1
    1678.143 |                                         1

SQL statistics:
    queries performed:
        read:                            8666026
        write:                           2476050
        other:                           1238011
        total:                           12380087
    transactions:                        619013 (171.93 per sec.)
    queries:                             12380087 (3438.57 per sec.)
    ignored errors:                      1      (0.00 per sec.)
    reconnects:                          0      (0.00 per sec.)

Throughput:
    events/s (eps):                      171.9309
    time elapsed:                        3600.3597s
    total number of events:              619013

Latency (ms):
         min:                                    3.51
         avg:                                   93.05
         max:                                 1683.16
         99th percentile:                      434.83
         sum:                             57601113.83

Threads fairness:
    events (avg/stddev):           38688.2500/159.52
    execution time (avg/stddev):   3600.0696/0.09

```